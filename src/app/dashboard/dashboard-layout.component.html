<mat-sidenav-container fullscreen>
  <!-- Menú lateral (sidenav) -->
  <mat-sidenav #sidenav mode="push" [ngStyle]="{ width: '250px' }">
    <mat-toolbar color="primary">
      <span class="ml-3">Menú</span>
      <span class="spacer"></span>
      <button mat-icon-button (click)="sidenav.toggle()">
        <mat-icon>close</mat-icon>
      </button>
    </mat-toolbar>

    <mat-nav-list>
      <mat-list-item
        *ngFor="let item of sidebarItems"
        [routerLink]="item.url"
        (click)="sidenav.toggle()"
        class="nav-item"
      >
        <mat-icon matListItemIcon>{{ item.icon }}</mat-icon>
        <span>{{ item.label }}</span>
      </mat-list-item>
    </mat-nav-list>
  </mat-sidenav>

  <!-- Navbar con los colores de la bandera de España -->
  <mat-toolbar class="toolbar">
    <div class="navbar-section red-section left-section">
      <div class="hamburger-menu" (click)="sidenav.toggle()">
        <div class="bar"></div>
        <div class="bar"></div>
        <div class="bar"></div>
      </div>
    </div>

    <div class="navbar-section yellow-section center-section">
      <img src="../../../../assets/escudo_espana.png" alt="Escudo de España" class="escudo" />
      <span class="site-title">El Conservador</span>
    </div>

    <div class="navbar-section red-section right-section">
      <button mat-icon-button [matMenuTriggerFor]="userMenu">
        <mat-icon>person</mat-icon>
      </button>
      <mat-menu #userMenu="matMenu">
        <button mat-menu-item (click)="onEditProfile()">
          <mat-icon>edit</mat-icon>
          <span>Editar Perfil</span>
        </button>
        <button mat-menu-item (click)="onLogout()">
          <mat-icon>exit_to_app</mat-icon>
          <span>Cerrar Sesión</span>
        </button>
      </mat-menu>
      <button mat-icon-button (click)="openExternalLink('https://www.instagram.com')">
        <mat-icon svgIcon="instagram"></mat-icon>
      </button>
      <button mat-icon-button (click)="openExternalLink('https://www.facebook.com')">
        <mat-icon svgIcon="facebook"></mat-icon>
      </button>
    </div>
  </mat-toolbar>

  <!-- Contenido del Dashboard -->
  <div class="container p-2">
    <div class="dashboard-container">
      <h1 class="patriotic-title text-4xl font-bold text-center mb-2">Bienvenido/a, {{ user()?.name }}</h1>
      <p class="patriotic-subtitle text-xl text-center mb-4">Panel de Control de El Conservador</p>

      <div class="grid">
        <div class="col-12 md:col-6 lg:col-3 mb-4">
          <mat-card class="patriotic-card h-full">
            <mat-card-header>
              <mat-card-title>Paquete Activo</mat-card-title>
            </mat-card-header>
            <mat-card-content>
              <p class="mb-2">{{ activePackage.name }}</p>
              <p>{{ activePackage.details }}</p>
            </mat-card-content>
            <mat-card-actions>
              <button mat-raised-button class="donation-btn" routerLink="/packages">Gestionar Paquete</button>
            </mat-card-actions>
          </mat-card>
        </div>

        <div class="col-12 md:col-6 lg:col-3 mb-4">
          <mat-card class="patriotic-card h-full">
            <mat-card-header>
              <mat-card-title>Estadísticas</mat-card-title>
            </mat-card-header>
            <mat-card-content>
              <ul class="patriotic-list">
                <li class="mb-2">Noticias publicadas: {{ stats.publishedNews }}</li>
                <li>Vistas totales: {{ stats.totalViews }}</li>
              </ul>
            </mat-card-content>
          </mat-card>
        </div>

        <div class="col-12 md:col-6 lg:col-3 mb-4">
          <mat-card class="patriotic-card h-full">
            <mat-card-header>
              <mat-card-title>Acciones Rápidas</mat-card-title>
            </mat-card-header>
            <mat-card-content>
              <button mat-raised-button class="donation-btn mb-2 w-full" (click)="onEditProfile()">Editar Perfil</button>
              <button mat-raised-button class="custom-warn-button w-full" (click)="onLogout()">Cerrar Sesión</button>
            </mat-card-content>
          </mat-card>
        </div>

        <div class="col-12 md:col-6 lg:col-3 mb-4">
          <mat-card class="patriotic-card h-full">
            <mat-card-header>
              <mat-card-title>Últimas Noticias</mat-card-title>
            </mat-card-header>
            <mat-card-content>
              <mat-list>
                <mat-list-item *ngFor="let news of latestNews">
                  <mat-icon matListItemIcon>article</mat-icon>
                  <span matListItemTitle>{{ news.title }}</span>
                  <span matListItemLine class="news-date">{{ news.date | date:'short' }}</span>
                </mat-list-item>
              </mat-list>
            </mat-card-content>
            <mat-card-actions>
              <button mat-raised-button class="donation-btn" routerLink="/news">Ver Todas</button>
            </mat-card-actions>
          </mat-card>
        </div>
      </div>
    </div>
  </div>
</mat-sidenav-container>
